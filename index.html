<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Календар 2025 - Професійний Дизайн</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Стиль "Wonder LLC" (Мінімалізм та Професіоналізм) --- */
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background: #F3F4F6; /* Світло-сірий фон */
            color: #1F2937; /* Темний текст */
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.5); }
            70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
            100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }
        
        .search-highlight > span:first-child {
            animation: pulse 1.5s infinite;
        }

        /* Заголовки */
        h1 { color: #111827; }
        p { color: #4B5563; }

        /* Картки місяців та фільтрів */
        .panel {
            background: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.07);
        }
        
        .current-month-glow {
            border-color: #3B82F6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.2);
        }
        
        /* Шапки місяців */
        .month-header {
            background-color: #F9FAFB;
            border-bottom: 1px solid #E5E7EB;
            color: #111827;
        }
        .month-header-clickable {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .month-header-clickable:hover {
            background-color: #F3F4F6;
        }

        /* Стилі для клітинок календаря */
        .calendar-day {
            transition: transform 0.2s ease-in-out, background-color 0.2s;
            border-radius: 8px;
        }
        .calendar-day:hover:not(.empty) {
            transform: scale(1.05);
            background-color: #EFF6FF;
            z-index: 10;
        }
        .weekend { background-color: #F9FAFB; }
        .today > span:first-child {
             background-color: #3B82F6;
             color: white;
             border-radius: 50%;
             width: 2.25rem;
             height: 2.25rem;
             display: inline-flex;
             align-items: center;
             justify-content: center;
             font-weight: 600;
        }
        
        /* Стилі для фільтрів */
        .form-checkbox, .form-input, #country-filter-button, #clear-filters-btn {
            background-color: #FFFFFF !important;
            border: 1px solid #D1D5DB !important;
            color: #1F2937 !important;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-checkbox:focus, .form-input:focus, #country-filter-button:focus {
            outline: none;
            border-color: #3B82F6 !important;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
        }
        .form-checkbox:checked {
            background-color: #3B82F6 !important;
            border-color: #3B82F6 !important;
        }
        #clear-filters-btn:hover {
            background-color: #F9FAFB !important;
        }
        ::placeholder { color: #9CA3AF !important; }
        
        /* Спливаючі елементи */
        #tooltip {
            background: #1F2937;
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        #country-filter-dropdown {
            background: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        #country-list li:hover {
            background-color: #EFF6FF;
        }
        .flag-icon { border: 1px solid #E5E7EB; }

        /* Стилі для перемикання вкладок */
        .view { display: none; }
        .view.active { display: block; }
        .month-view-grid { display: none; }
        .month-view-grid.active { display: grid; }
        .day-view-panel { display: none; }
        .day-view-panel.active { display: block; }

        /* Хлібні крихти */
        .breadcrumb-link {
            cursor: pointer;
            transition: color 0.2s;
        }
        .breadcrumb-link:hover {
            color: #3B82F6;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-4">
            <h1 class="text-4xl md:text-5xl font-bold">Глобальний Календар 2025</h1>
            <p class="mt-2 text-lg">Інтерактивний огляд свят та подій у світі</p>
        </header>

        <nav id="breadcrumbs" class="text-center text-gray-500 mb-4 font-medium"></nav>
        
        <div id="holiday-counter-container" class="text-center mb-4 font-semibold text-gray-600">
            <span id="holiday-counter"></span>
        </div>

        <!-- Панель фільтрів -->
        <div id="filters" class="mb-8 p-4 grid-cols-1 md:grid-cols-3 gap-4 items-center panel hidden" data-selected-country="all">
            <!-- Фільтр за країною -->
            <div class="relative">
                <label class="block text-sm font-medium mb-1">Країна:</label>
                <button id="country-filter-button" class="w-full flex items-center justify-between text-left p-2 rounded-md">
                    <span class="flex items-center">
                        <img id="selected-country-flag" class="flag-icon mr-2 hidden" alt="flag">
                        <span id="selected-country-name">Всі країни</span>
                    </span>
                    <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </button>
                <div id="country-filter-dropdown" class="absolute hidden mt-1 w-full z-20 p-2 origin-top" >
                    <input type="text" id="country-search-input" placeholder="Пошук країни..." class="w-full p-2 mb-2 rounded-md form-input">
                    <ul id="country-list" class="max-h-60 overflow-y-auto">
                        <!-- Опції країн додаються динамічно -->
                    </ul>
                </div>
            </div>
            <!-- Фільтр за типом свята -->
            <div class="flex flex-wrap gap-x-4 gap-y-2 items-center justify-center">
                 <label class="block text-sm font-medium md:hidden">Тип свята:</label>
                 <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="type-filter form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500" value="red" checked>
                    <span class="ml-2">Національні</span>
                </label>
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="type-filter form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500" value="purple" checked>
                    <span class="ml-2">Релігійні</span>
                </label>
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="type-filter form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500" value="green" checked>
                    <span class="ml-2">Агрономічні</span>
                </label>
            </div>
             <!-- Пошук та кнопка очищення -->
            <div class="flex items-end gap-2">
                <div class="flex-grow">
                    <label class="block text-sm font-medium mb-1">Пошук за назвою:</label>
                    <input type="text" id="search-filter" placeholder="Наприклад, День незалежності" class="w-full p-2 rounded-md form-input">
                </div>
                <button id="clear-filters-btn" title="Очистити фільтри" class="p-2 rounded-md">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                </button>
            </div>
        </div>
        
        <!-- Контейнери для різних рівнів перегляду -->
        <div id="year-view" class="view grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8"></div>
        <div id="month-view" class="view"></div>
        <div id="day-view" class="view"></div>
    </div>

    <div id="tooltip"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ПОВНА ОНОВЛЕНА БАЗА ДАНИХ СВЯТ ---
            const holidays = {
                // СІЧЕНЬ
                "2025-01-01": [{ name: "Новий рік", shortName: "Новий рік", type: "red", countries: ["Швейцарія", "Сербія", "Японія", "Косово", "Австралія", "Північна Македонія", "Ізраїль", "Молдова", "Грузія", "ПАР", "Вірменія", "Тайвань", "Таїланд", "Казахстан", "Сінгапур", "Нова Зеландія", "Південна Корея", "Туніс", "Ямайка", "Руанда", "Тринідад і Тобаго", "Сенегал", "Сьєрра-Леоне", "Австрія", "Канада", "Німеччина", "Греція", "Болгарія", "Нідерланди", "Бельгія", "Хорватія", "Боснія і Герцеговина", "Кенія", "Танзанія", "Уганда"] }],
                "2025-01-02": [{ name: "День після Нового року", shortName: "Після НР", type: "red", countries: ["Нова Зеландія"] }, { name: "Свято 2 січня", shortName: "2 січня", type: "red", countries: ["Шотландія (Велика Британія)"] }],
                "2025-01-06": [{ name: "Богоявлення (Водохреща)", shortName: "Водохреща", type: "purple", countries: ["Австрія", "Німеччина", "Греція"] }],
                "2025-01-07": [{ name: "Православне Різдво", shortName: "Різдво", type: "purple", countries: ["Сербія", "Північна Македонія", "Грузія", "Вірменія", "Боснія і Герцеговина"] }],
                "2025-01-13": [{ name: "Православний Новий рік", shortName: "Старий НР", type: "purple", countries: ["Сербія", "Північна Македонія", "Грузія"] }],
                "2025-01-14": [{ name: "Макар Санкранті", shortName: "Санкранті", type: "green", countries: ["Індія"] }],
                "2025-01-26": [{ name: "День Республіки", shortName: "День Респ.", type: "red", countries: ["Індія"] }],
                "2025-01-27": [{ name: "День Австралії", shortName: "День Австр.", type: "red", countries: ["Австралія"] }],
                // ЛЮТИЙ
                "2025-02-01": [{ name: "День Федеральних територій", shortName: "День ФТ", type: "red", countries: ["Малайзія"] }],
                "2025-02-03": [{ name: "День Героїв", shortName: "День Героїв", type: "red", countries: ["Мозамбік"] }],
                "2025-02-11": [{ name: "День заснування держави", shortName: "День засн.", type: "red", countries: ["Японія"] }],
                "2025-02-12": [{ name: "День Союзу", shortName: "День Союзу", type: "red", countries: ["М'янма"] }],
                "2025-02-16": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Литва"] }],
                "2025-02-18": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Гамбія"] }],
                "2025-02-21": [{ name: "Міжнародний день рідної мови", shortName: "День мови", type: "red", countries: ["Бангладеш"] }],
                "2025-02-23": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Бруней"] }],
                "2025-02-24": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Естонія"] }],
                // БЕРЕЗЕНЬ
                "2025-03-01": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Боснія і Герцеговина"] }, { name: "Початок Рамадану", shortName: "Рамадан", type: "purple", countries: ["Ісламські країни"] }, { name: "Початок весняної посівної", shortName: "Посівна", type: "green", countries: ["Північна півкуля"] }],
                "2025-03-03": [{ name: "День визволення", shortName: "День визв.", type: "red", countries: ["Болгарія"] }],
                "2025-03-06": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Гана"] }],
                "2025-03-08": [{ name: "Міжнародний жіночий день", shortName: "Жіночий день", type: "red", countries: ["Вірменія", "Грузія", "Казахстан", "Узбекистан", "Молдова"] }],
                "2025-03-12": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Маврикій"] }],
                "2025-03-14": [{ name: "Холі", shortName: "Холі", type: "purple", countries: ["Індія", "Непал", "Маврикій", "Тринідад і Тобаго", "Сінгапур", "Малайзія"] }],
                "2025-03-17": [{ name: "День святого Патрика", shortName: "Св. Патрик", type: "red", countries: ["Ірландія"] }],
                "2025-03-20": [{ name: "День весняного рівнодення", shortName: "Рівнодення", type: "green", countries: ["Японія"] }],
                "2025-03-21": [{ name: "Новруз (Перський Новий рік)", shortName: "Новруз", type: "green", countries: ["Казахстан", "Узбекистан"] }],
                "2025-03-23": [{ name: "День Пакистану", shortName: "День Пак.", type: "red", countries: ["Пакистан"] }],
                "2025-03-25": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Греція"] }],
                "2025-03-26": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Бангладеш"] }],
                "2025-03-30": [{ name: "Ід аль-Фітр (Ураза-байрам)", shortName: "Ураза-байрам", type: "purple", countries: ["Ісламські країни"] }],
                "2025-03-31": [{ name: "Ід аль-Фітр (Ураза-байрам)", shortName: "Ураза-байрам", type: "purple", countries: ["Ісламські країни"] }],
                // КВІТЕНЬ
                "2025-04-01": [{ name: "Сезон збору кукурудзи (Африка)", shortName: "Збір кукур.", type: "green", countries: ["Африка"] }, { name: "Початок зимової посівної", shortName: "Посівна", type: "green", countries: ["Південна півкуля"] }],
                "2025-04-04": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Сенегал"] }],
                "2025-04-06": [{ name: "День Чакрі", shortName: "День Чакрі", type: "red", countries: ["Таїланд"] }],
                "2025-04-13": [{ name: "Сонгкран (Тайський Новий рік)", shortName: "Сонгкран", type: "red", countries: ["Таїланд"] }, { name: "Песах", shortName: "Песах", type: "purple", countries: ["Ізраїль"] }],
                "2025-04-14": [{ name: "Сонгкран (Тайський Новий рік)", shortName: "Сонгкран", type: "red", countries: ["Таїланд"] }, { name: "Новий рік", shortName: "Новий рік", type: "red", countries: ["Камбоджа", "М'янма", "Шрі-Ланка"] }],
                "2025-04-15": [{ name: "Сонгкран (Тайський Новий рік)", shortName: "Сонгкран", type: "red", countries: ["Таїланд"] }],
                "2025-04-17": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Сирія"] }],
                "2025-04-18": [{ name: "Страсна п'ятниця", shortName: "Стр. п'ятн.", type: "purple", countries: ["Швейцарія", "Австралія", "Нова Зеландія", "ПАР", "Ямайка", "Тринідад і Тобаго", "Австрія", "Канада", "Німеччина", "Нідерланди", "Бельгія", "Хорватія", "Кенія", "Танзанія", "Уганда"] }],
                "2025-04-21": [{ name: "Великодній понеділок", shortName: "Великдень", type: "purple", countries: ["Швейцарія", "Австралія", "Нова Зеландія", "Австрія", "Німеччина", "Нідерланди", "Бельгія", "Хорватія"] }],
                "2025-04-25": [{ name: "День АНЗАК", shortName: "День АНЗАК", type: "red", countries: ["Австралія", "Нова Зеландія"] }],
                "2025-04-27": [{ name: "День Свободи", shortName: "День Своб.", type: "red", countries: ["ПАР"] }],
                "2025-04-30": [{ name: "День Короля", shortName: "День Короля", type: "red", countries: ["Нідерланди"] }],
                // ТРАВЕНЬ
                "2025-05-01": [{ name: "День праці", shortName: "День праці", type: "red", countries: ["Швейцарія", "Алжир", "Сербія", "Косово", "Північна Македонія", "Молдова", "Бангладеш", "Нігерія", "Грузія", "Вірменія", "Казахстан", "Узбекистан", "Кот-д'Івуар", "Шрі-Ланка", "Судан", "Пакистан", "Бенін", "Ботсвана", "Індонезія", "Того", "Гана", "Малайзія", "Ангола", "Ефіопія", "Сінгапур", "Замбія", "Філіппіни", "Зімбабве", "Гвінея", "Лесото", "Південна Корея", "Туніс", "Руанда", "Камерун", "Тринідад і Тобаго", "Сенегал", "Китай", "Сьєрра-Леоне", "Австрія", "Німеччина", "Греція", "Болгарія", "Бельгія", "Хорватія", "Нігер", "Боснія і Герцеговина", "Марокко", "Туреччина", "Кенія", "Танзанія", "Уганда"] }],
                "2025-05-05": [{ name: "День визволення", shortName: "День визв.", type: "red", countries: ["Нідерланди"] }],
                "2025-05-08": [{ name: "День Перемоги в Європі", shortName: "День Перемоги", type: "red", countries: ["Європейські країни"] }],
                "2025-05-09": [{ name: "День Перемоги", shortName: "День Перемоги", type: "red", countries: ["Вірменія", "Казахстан", "Узбекистан"] }],
                "2025-05-12": [{ name: "Весак", shortName: "Весак", type: "purple", countries: ["Таїланд", "Камбоджа", "М'янма", "Шрі-Ланка", "В'єтнам"] }],
                "2025-05-24": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Еритрея"] }],
                "2025-05-25": [{ name: "День Африки", shortName: "День Африки", type: "red", countries: ["Африканські країни"] }],
                "2025-05-26": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Грузія"] }],
                "2025-05-28": [{ name: "День Республіки", shortName: "День Респ.", type: "red", countries: ["Вірменія"] }],
                // ЧЕРВЕНЬ
                "2025-06-01": [{ name: "День дітей", shortName: "День дітей", type: "red", countries: ["Китай"] }, { name: "Сезон збору пшениці", shortName: "Збір пшениці", type: "green", countries: ["Північна півкуля"] }, { name: "Початок мусонної посівної", shortName: "Посівна", type: "green", countries: ["Південна Азія"] }],
                "2025-06-02": [{ name: "День Республіки", shortName: "День Респ.", type: "red", countries: ["Італія"] }],
                "2025-06-05": [{ name: "День Конституції", shortName: "День Конст.", type: "red", countries: ["Данія"] }],
                "2025-06-06": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Швеція"] }, { name: "Ід аль-Адха (Курбан-байрам)", shortName: "Курбан-байрам", type: "purple", countries: ["Ісламські країни"] }],
                "2025-06-07": [{ name: "Ід аль-Адха (Курбан-байрам)", shortName: "Курбан-байрам", type: "purple", countries: ["Ісламські країни"] }],
                "2025-06-10": [{ name: "День Португалії", shortName: "День Порт.", type: "red", countries: ["Португалія"] }],
                "2025-06-12": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Філіппіни"] }],
                "2025-06-16": [{ name: "День молоді", shortName: "День молоді", type: "red", countries: ["ПАР"] }],
                "2025-06-17": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Ісландія"] }],
                "2025-06-23": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Люксембург"] }],
                "2025-06-24": [{ name: "День святого Іоанна", shortName: "Іоанна", type: "purple", countries: ["Різні країни"] }],
                "2025-06-25": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Хорватія", "Словенія"] }],
                "2025-06-26": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Мадагаскар"] }, { name: "Ісламський Новий рік", shortName: "Ісл. НР", type: "purple", countries: ["Ісламські країни"] }],
                "2025-06-27": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Джибуті"] }],
                // ЛИПЕНЬ
                "2025-07-01": [{ name: "День Канади", shortName: "День Канади", type: "red", countries: ["Канада"] }],
                "2025-07-05": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Алжир", "Кабо-Верде"] }],
                "2025-07-09": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Південний Судан"] }],
                "2025-07-10": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Багами"] }, { name: "Асалха Пуджа", shortName: "Асалха Пуджа", type: "purple", countries: ["Таїланд", "Камбоджа", "М'янма", "Шрі-Ланка"] }],
                "2025-07-11": [{ name: "Початок буддійського посту", shortName: "Будд. піст", type: "purple", countries: ["Таїланд", "Камбоджа", "М'янма", "Шрі-Ланка"] }],
                "2025-07-12": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Сан-Томе і Принсіпі"] }],
                "2025-07-14": [{ name: "День взяття Бастилії", shortName: "День Баст.", type: "red", countries: ["Франція"] }],
                "2025-07-20": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Колумбія"] }],
                "2025-07-21": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Бельгія"] }],
                "2025-07-23": [{ name: "День Революції", shortName: "День Рев.", type: "red", countries: ["Єгипет"] }],
                "2025-07-26": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Ліберія", "Мальдіви"] }],
                "2025-07-28": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Перу"] }],
                "2025-07-30": [{ name: "День трону", shortName: "День трону", type: "red", countries: ["Марокко"] }],
                // СЕРПЕНЬ
                "2025-08-01": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Швейцарія"] }],
                "2025-08-06": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Ямайка", "Болівія"] }],
                "2025-08-09": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Сінгапур"] }],
                "2025-08-10": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Еквадор"] }],
                "2025-08-11": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Чад"] }],
                "2025-08-15": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Індія"] }, { name: "День визволення", shortName: "День визв.", type: "red", countries: ["Південна Корея"] }, { name: "Успіння Пресвятої Богородиці", shortName: "Успіння", type: "purple", countries: ["Австрія", "Бельгія", "Франція", "Греція", "Італія", "Польща", "Португалія", "Іспанія"] }],
                "2025-08-17": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Індонезія"] }],
                "2025-08-19": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Афганістан"] }],
                "2025-08-24": [{ name: "День Незалежності України", shortName: "День нез. Укр.", type: "red", countries: ["Україна"] }],
                "2025-08-25": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Уругвай"] }],
                "2025-08-27": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Молдова"] }],
                "2025-08-31": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Малайзія", "Тринідад і Тобаго", "Киргизстан"] }],
                // ВЕРЕСЕНЬ
                "2025-09-01": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Узбекистан"] }, { name: "Сезон збору рису (Азія)", shortName: "Збір рису", type: "green", countries: ["Азія"] }, { name: "Сезон збору бавовни", shortName: "Збір бавовни", type: "green", countries: ["Різні країни"] }],
                "2025-09-02": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["В'єтнам"] }],
                "2025-09-03": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Катар"] }],
                "2025-09-04": [{ name: "Мавлід ан-Набі", shortName: "Мавлід", type: "purple", countries: ["Ісламські країни"] }],
                "2025-09-07": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Бразилія"] }],
                "2025-09-08": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Північна Македонія"] }],
                "2025-09-09": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Таджикистан"] }],
                "2025-09-15": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Коста-Рика", "Сальвадор", "Гватемала", "Гондурас", "Нікарагуа"] }],
                "2025-09-16": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Мексика", "Папуа-Нова Гвінея"] }, { name: "Рош га-Шана", shortName: "Рош га-Шана", type: "purple", countries: ["Ізраїль"] }],
                "2025-09-17": [{ name: "Рош га-Шана", shortName: "Рош га-Шана", type: "purple", countries: ["Ізраїль"] }],
                "2025-09-18": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Чилі"] }],
                "2025-09-21": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Вірменія", "Беліз", "Мальта"] }],
                "2025-09-22": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Малі"] }],
                "2025-09-23": [{ name: "День осіннього рівнодення", shortName: "Рівнодення", type: "green", countries: ["Японія"] }],
                "2025-09-24": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Гвінея-Бісау"] }],
                "2025-09-25": [{ name: "Йом-Кіпур", shortName: "Йом-Кіпур", type: "purple", countries: ["Ізраїль"] }],
                "2025-09-30": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Ботсвана"] }, { name: "Суккот", shortName: "Суккот", type: "purple", countries: ["Ізраїль"] }],
                // ЖОВТЕНЬ
                "2025-10-01": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Китай", "Нігерія", "Кіпр"] }],
                "2025-10-02": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Гвінея"] }, { name: "Душера", shortName: "Душера", type: "purple", countries: ["Індія", "Непал"] }],
                "2025-10-03": [{ name: "День німецької єдності", shortName: "День єдн.", type: "red", countries: ["Німеччина"] }],
                "2025-10-04": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Лесото"] }],
                "2025-10-09": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Уганда"] }],
                "2025-10-10": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Фіджі"] }],
                "2025-10-12": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Екваторіальна Гвінея"] }],
                "2025-10-20": [{ name: "Дівалі", shortName: "Дівалі", type: "purple", countries: ["Індія", "Непал", "Маврикій", "Тринідад і Тобаго", "Сінгапур", "Малайзія"] }],
                "2025-10-24": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Замбія"] }],
                "2025-10-26": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Австрія"] }],
                "2025-10-27": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Туркменістан"] }],
                "2025-10-28": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Чехія"] }],
                "2025-10-29": [{ name: "День Республіки", shortName: "День Респ.", type: "red", countries: ["Туреччина"] }],
                // ЛИСТОПАД
                "2025-11-01": [{ name: "День усіх святих", shortName: "Всіх святих", type: "purple", countries: ["Австрія", "Бельгія", "Франція", "Німеччина", "Італія", "Польща", "Португалія", "Іспанія"] }],
                "2025-11-03": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Панама"] }],
                "2025-11-09": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Камбоджа"] }],
                "2025-11-11": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Ангола", "Польща"] }, { name: "День перемир'я", shortName: "День перемир'я", type: "red", countries: ["Різні країни"] }],
                "2025-11-18": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Латвія"] }],
                "2025-11-22": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Ліван"] }],
                "2025-11-25": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Суринам"] }],
                "2025-11-28": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Албанія", "Мавританія"] }],
                // ГРУДЕНЬ
                "2025-12-01": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Румунія"] }],
                "2025-12-02": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["ОАЕ", "Лаос"] }],
                "2025-12-06": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Фінляндія"] }],
                "2025-12-08": [{ name: "Непорочне зачаття", shortName: "Непор. зач.", type: "purple", countries: ["Австрія", "Бельгія", "Італія", "Португалія", "Іспанія"] }],
                "2025-12-09": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Танзанія"] }],
                "2025-12-12": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Кенія"] }],
                "2025-12-16": [{ name: "День Незалежності", shortName: "День нез.", type: "red", countries: ["Казахстан", "Бахрейн"] }],
                "2025-12-17": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Бутан"] }],
                "2025-12-18": [{ name: "Національний день", shortName: "Нац. день", type: "red", countries: ["Катар"] }],
                "2025-12-24": [{ name: "Святвечір", shortName: "Святвечір", type: "purple", countries: ["Християнські країни"] }],
                "2025-12-25": [{ name: "Різдво Христове", shortName: "Різдво", type: "purple", countries: ["Швейцарія", "Австралія", "Нова Зеландія", "ПАР", "Ямайка", "Руанда", "Тринідад і Тобаго", "Сьєрра-Леоне", "Австрія", "Канада", "Німеччина", "Греція", "Болгарія", "Нідерланди", "Бельгія", "Хорватія", "Боснія і Герцеговина", "Кенія", "Танзанія", "Уганда", "Філіппіни", "Південна Корея"] }],
                "2025-12-26": [{ name: "День подарунків / День св. Стефана", shortName: "День подарунків", type: "red", countries: ["Австралія", "Нова Зеландія", "ПАР", "Канада", "Німеччина", "Австрія"] }],
                "2025-12-31": [{ name: "Переддень Нового року", shortName: "Переддень НР", type: "red", countries: ["Весь світ"] }]
            };

            // Глобальні змінні
            const monthNames = ["Січень", "Лютий", "Березень", "Квітень", "Травень", "Червень", "Липень", "Серпень", "Вересень", "Жовтень", "Листопад", "Грудень"];
            const dayNames = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Нд"];
            const year = 2025;
            
            // Елементи DOM
            const yearView = document.getElementById('year-view');
            const monthView = document.getElementById('month-view');
            const dayView = document.getElementById('day-view');
            const breadcrumbs = document.getElementById('breadcrumbs');
            const filtersPanel = document.getElementById('filters');
            const tooltip = document.getElementById('tooltip');
            const holidayCounter = document.getElementById('holiday-counter');
            const countryFilterButton = document.getElementById('country-filter-button');
            const countryFilterDropdown = document.getElementById('country-filter-dropdown');
            const countrySearchInput = document.getElementById('country-search-input');
            const countryList = document.getElementById('country-list');
            const selectedCountryName = document.getElementById('selected-country-name');
            const selectedCountryFlag = document.getElementById('selected-country-flag');
            const typeFilters = document.querySelectorAll('.type-filter');
            const searchFilter = document.getElementById('search-filter');
            const clearFiltersBtn = document.getElementById('clear-filters-btn');

            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            let activeTooltipDay = null;
            let state = { view: 'year', month: null, day: null };
            
            // Коди країн для прапорів
            const countryCodes = {"Афганістан":"af","Албанія":"al","Алжир":"dz","Ангола":"ao","Вірменія":"am","Австралія":"au","Австрія":"at","Багами":"bs","Бахрейн":"bh","Бангладеш":"bd","Бельгія":"be","Беліз":"bz","Бенін":"bj","Бутан":"bt","Болівія":"bo","Боснія і Герцеговина":"ba","Ботсвана":"bw","Бразилія":"br","Бруней":"bn","Болгарія":"bg","Камбоджа":"kh","Камерун":"cm","Канада":"ca","Кабо-Верде":"cv","Чад":"td","Чилі":"cl","Китай":"cn","Колумбія":"co","Коста-Рика":"cr","Кот-д'Івуар":"ci","Хорватія":"hr","Кіпр":"cy","Чехія":"cz","Данія":"dk","Джибуті":"dj","Еквадор":"ec","Єгипет":"eg","Сальвадор":"sv","Екваторіальна Гвінея":"gq","Еритрея":"er","Естонія":"ee","Ефіопія":"et","Фіджі":"fj","Фінляндія":"fi","Франція":"fr","Гамбія":"gm","Грузія":"ge","Німеччина":"de","Гана":"gh","Греція":"gr","Гватемала":"gt","Гвінея":"gn","Гвінея-Бісау":"gw","Гондурас":"hn","Ісландія":"is","Індія":"in","Індонезія":"id","Ірландія":"ie","Ізраїль":"il","Італія":"it","Ямайка":"jm","Японія":"jp","Казахстан":"kz","Кенія":"ke","Косово":"xk","Кувейт":"kw","Киргизстан":"kg","Лаос":"la","Латвія":"lv","Ліван":"lb","Лесото":"ls","Ліберія":"lr","Литва":"lt","Люксембург":"lu","Мадагаскар":"mg","Малайзія":"my","Мальдіви":"mv","Малі":"ml","Мальта":"mt","Мавританія":"mr","Маврикій":"mu","Мексика":"mx","Молдова":"md","Марокко":"ma","Мозамбік":"mz","М'янма":"mm","Непал":"np","Нідерланди":"nl","Нова Зеландія":"nz","Нікарагуа":"ni","Нігер":"ne","Нігерія":"ng","Північна Македонія":"mk","Норвегія":"no","Пакистан":"pk","Панама":"pa","Папуа-Нова Гвінея":"pg","Перу":"pe","Філіппіни":"ph","Польща":"pl","Португалія":"pt","Катар":"qa","Румунія":"ro","Руанда":"rw","Сан-Томе і Принсіпі":"st","Саудівська Аравія":"sa","Сенегал":"sn","Сербія":"rs","Сьєрра-Леоне":"sl","Сінгапур":"sg","Словенія":"si","ПАР":"za","Південна Корея":"kr","Південний Судан":"ss","Іспанія":"es","Шрі-Ланка":"lk","Судан":"sd","Суринам":"sr","Швеція":"se","Швейцарія":"ch","Сирія":"sy","Тайвань":"tw","Таджикистан":"tj","Танзанія":"tz","Таїланд":"th","Того":"tg","Тринідад і Тобаго":"tt","Туніс":"tn","Туреччина":"tr","Туркменістан":"tm","Уганда":"ug","Україна":"ua","ОАЕ":"ae","Велика Британія":"gb","Уругвай":"uy","Узбекистан":"uz","В'єтнам":"vn","Ємен":"ye","Замбія":"zm","Зімбабве":"zw"};

            function switchView(newView, options = {}) {
                state.view = newView;
                state.month = options.monthIndex ?? state.month;
                state.day = options.dateStr ?? state.day;

                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                document.getElementById(`${newView}-view`).classList.add('active');

                if (newView === 'day') {
                    filtersPanel.style.display = 'none';
                    holidayCounter.parentElement.style.display = 'none';
                } else {
                    filtersPanel.style.display = 'grid';
                    holidayCounter.parentElement.style.display = 'block';
                }

                renderContent();
                renderBreadcrumbs();
            }

            function renderContent() {
                if (state.view === 'year') {
                    renderYearView();
                } else if (state.view === 'month') {
                    renderMonthView(state.month);
                } else if (state.view === 'day') {
                    renderDayView(state.day);
                }
            }

            function renderBreadcrumbs() {
                breadcrumbs.innerHTML = '';
                const yearLink = document.createElement('span');
                yearLink.textContent = 'Річний огляд';
                yearLink.className = 'breadcrumb-link';
                yearLink.onclick = () => switchView('year');
                breadcrumbs.appendChild(yearLink);

                if (state.view === 'month' || state.view === 'day') {
                    breadcrumbs.innerHTML += ' / ';
                    const monthLink = document.createElement('span');
                    monthLink.textContent = monthNames[state.month];
                    monthLink.className = 'breadcrumb-link';
                    monthLink.onclick = () => switchView('month', { monthIndex: state.month });
                    breadcrumbs.appendChild(monthLink);
                }

                if (state.view === 'day') {
                    breadcrumbs.innerHTML += ' / ';
                    const dayLink = document.createElement('span');
                    dayLink.textContent = new Date(state.day).getDate();
                    breadcrumbs.appendChild(dayLink);
                }
            }

            function renderYearView() {
                yearView.innerHTML = '';
                const today = new Date();
                const currentMonthIndex = today.getMonth();
                const currentYear = today.getFullYear();

                monthNames.forEach((monthName, monthIndex) => {
                    const monthDiv = document.createElement('div');
                    monthDiv.className = `panel p-4`;
                    if(monthIndex === currentMonthIndex && year === currentYear) {
                        monthDiv.classList.add('current-month-glow');
                    }
                    
                    const header = document.createElement('div');
                    header.className = `month-header month-header-clickable p-3 -m-4 mb-4 font-bold text-xl text-center`;
                    header.style.borderTopLeftRadius = '12px';
                    header.style.borderTopRightRadius = '12px';
                    header.textContent = `${monthName}`;
                    header.onclick = () => switchView('month', { monthIndex });
                    monthDiv.appendChild(header);

                    const grid = document.createElement('div');
                    grid.className = 'grid grid-cols-7 gap-1 flex-grow';
                    
                    dayNames.forEach(day => {
                        grid.appendChild(Object.assign(document.createElement('div'), { className: 'text-center font-semibold text-gray-500 text-xs py-1', textContent: day }));
                    });

                    const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
                    const startOffset = (new Date(year, monthIndex, 1).getDay() === 0) ? 6 : new Date(year, monthIndex, 1).getDay() - 1;

                    for (let i = 0; i < startOffset; i++) {
                        grid.appendChild(document.createElement('div'));
                    }

                    for (let day = 1; day <= daysInMonth; day++) {
                        const dayCell = document.createElement('div');
                        dayCell.className = 'calendar-day relative flex items-center justify-center h-8 text-sm';
                        const dateStr = `${year}-${String(monthIndex + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                        dayCell.textContent = day;
                        if (holidays[dateStr]) {
                             dayCell.classList.add('has-holiday', 'font-bold', 'text-blue-600');
                        }
                        grid.appendChild(dayCell);
                    }
                    monthDiv.appendChild(grid);
                    yearView.appendChild(monthDiv);
                });
                updateFilteredHolidays();
            }

            function renderMonthView(monthIndex) {
                monthView.innerHTML = '';
                const monthDiv = document.createElement('div');
                monthDiv.className = 'panel p-6';
                
                const header = document.createElement('div');
                header.className = 'month-header p-4 -m-6 mb-6 font-bold text-2xl text-center';
                header.style.borderTopLeftRadius = '12px';
                header.style.borderTopRightRadius = '12px';
                header.textContent = `${monthNames[monthIndex]} ${year}`;
                monthDiv.appendChild(header);
                
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-7 gap-2';

                dayNames.forEach(day => {
                    grid.appendChild(Object.assign(document.createElement('div'), { className: 'text-center font-bold text-gray-600 pb-2', textContent: day }));
                });

                const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
                const startOffset = (new Date(year, monthIndex, 1).getDay() === 0) ? 6 : new Date(year, monthIndex, 1).getDay() - 1;

                for (let i = 0; i < startOffset; i++) {
                    grid.appendChild(document.createElement('div'));
                }

                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = createDayCell(day, monthIndex, 'month');
                    grid.appendChild(dayCell);
                }
                monthDiv.appendChild(grid);
                monthView.appendChild(monthDiv);
                updateFilteredHolidays();
            }
            
            function renderDayView(dateStr) {
                dayView.innerHTML = '';
                const date = new Date(dateStr);
                const day = date.getDate();
                const monthIndex = date.getMonth();
                const weekday = date.toLocaleDateString('uk-UA', { weekday: 'long' });

                const panel = document.createElement('div');
                panel.className = 'panel p-6 max-w-2xl mx-auto';
                
                panel.innerHTML = `
                    <div class="text-center mb-4">
                        <h2 class="text-5xl font-bold">${day}</h2>
                        <p class="text-xl text-gray-500">${monthNames[monthIndex]}, ${weekday}</p>
                    </div>
                    <div id="day-holidays-list"></div>
                `;
                
                dayView.appendChild(panel);
                const list = document.getElementById('day-holidays-list');
                const dayHolidays = holidays[dateStr] || [];

                if(dayHolidays.length > 0) {
                    dayHolidays.forEach(h => {
                        const holidayEl = document.createElement('div');
                        holidayEl.className = 'p-4 border-t border-gray-200';
                        
                        let typeColorClass = '';
                        if (h.type === 'red') typeColorClass = 'text-red-500';
                        if (h.type === 'purple') typeColorClass = 'text-purple-500';
                        if (h.type === 'green') typeColorClass = 'text-green-500';

                        holidayEl.innerHTML = `
                            <h3 class="text-lg font-semibold ${typeColorClass}">${h.name}</h3>
                            <p class="text-sm text-gray-500">${h.countries.join(', ')}</p>
                        `;
                        list.appendChild(holidayEl);
                    });
                } else {
                    list.innerHTML = `<p class="text-center text-gray-500 py-4">На цей день немає запланованих свят.</p>`;
                }
            }

            function createDayCell(day, monthIndex, viewType) {
                const dayCell = document.createElement('div');
                const date = new Date(year, monthIndex, day);
                const dayOfWeek = date.getDay();
                dayCell.className = `calendar-day relative flex items-center justify-center h-16 cursor-pointer`;
                
                if (dayOfWeek === 6 || dayOfWeek === 0) dayCell.classList.add('weekend');

                const dayNumber = Object.assign(document.createElement('span'), { textContent: day, className: 'z-10' });
                dayCell.appendChild(dayNumber);

                const dateStr = `${year}-${String(monthIndex + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                dayCell.dataset.date = dateStr;

                if (dateStr === new Date().toISOString().slice(0, 10)) dayCell.classList.add('today');
                
                if (holidays[dateStr]) {
                    dayCell.classList.add('has-holiday');
                    dayCell.dataset.holidays = JSON.stringify(holidays[dateStr]);
                    
                    if(viewType === 'month') {
                        dayCell.onclick = () => switchView('day', { dateStr });
                        if (isTouchDevice) {
                            dayCell.addEventListener('touchstart', (e) => {
                                if (e.touches.length === 1) { // Single touch
                                    activeTooltipDay = setTimeout(() => showTooltip(e, dayCell), 500); // Long press
                                }
                            });
                            dayCell.addEventListener('touchend', () => clearTimeout(activeTooltipDay));
                            dayCell.addEventListener('touchmove', () => clearTimeout(activeTooltipDay));
                        } else {
                            dayCell.addEventListener('mouseenter', (e) => showTooltip(e, dayCell));
                            dayCell.addEventListener('mouseleave', hideTooltip);
                            dayCell.addEventListener('mousemove', moveTooltip);
                        }
                    }
                }
                return dayCell;
            }

            function updateFilteredHolidays(isSearch = false) {
                const selectedCountry = filtersPanel.dataset.selectedCountry;
                const selectedTypes = Array.from(typeFilters).filter(cb => cb.checked).map(cb => cb.value);
                const searchQuery = searchFilter.value.toLowerCase();
                let firstFoundElement = null;
                let visibleHolidaysCount = 0;

                document.querySelectorAll('.calendar-day').forEach(dayCell => {
                    dayCell.classList.remove('search-highlight');
                    dayCell.querySelector('.holiday-markers')?.remove();
                    dayCell.querySelector('.short-name-label')?.remove();
                    dayCell.style.opacity = '1';
                    
                    if (!dayCell.classList.contains('has-holiday')) return;

                    const cellHolidays = JSON.parse(dayCell.dataset.holidays);
                    
                    const filteredHolidays = cellHolidays.filter(h => {
                        const countryMatch = selectedCountry === 'all' || h.countries.includes(selectedCountry) || h.countries.some(c => c.includes(selectedCountry));
                        const typeMatch = selectedTypes.includes(h.type);
                        const searchMatch = searchQuery === '' || h.name.toLowerCase().includes(searchQuery);
                        return countryMatch && typeMatch && searchMatch;
                    });

                    if (filteredHolidays.length > 0) {
                        visibleHolidaysCount += filteredHolidays.length;
                        dayCell.dataset.tooltipContent = filteredHolidays.map((h, index) => `
                            <div class="${index > 0 ? 'mt-2 pt-2 border-t border-gray-700' : ''}">
                                <strong class="block">${h.name}</strong>
                                <span class="text-xs text-gray-400">${h.countries.join(', ')}</span>
                            </div>`).join('');
                        
                        if (searchQuery.length > 0 && !firstFoundElement) {
                            firstFoundElement = dayCell;
                            dayCell.classList.add('search-highlight');
                        }
                        
                        const markersDiv = document.createElement('div');
                        markersDiv.className = 'holiday-markers absolute bottom-1 left-1/2 -translate-x-1/2 flex space-x-1';
                        const uniqueTypes = [...new Set(filteredHolidays.map(h => h.type))];
                        
                        uniqueTypes.forEach(type => {
                            const marker = document.createElement('div');
                            if (type === 'red') marker.className = 'w-2 h-2 rounded-full bg-red-500';
                            if (type === 'purple') marker.className = 'w-2 h-2 rounded-full bg-purple-500';
                            if (type === 'green') marker.className = 'w-2 h-2 rounded-full bg-green-500';
                            markersDiv.appendChild(marker);
                        });
                        dayCell.appendChild(markersDiv);
                    } else {
                        dayCell.style.opacity = '0.5';
                        dayCell.dataset.tooltipContent = '';
                    }
                });
                
                holidayCounter.textContent = `Знайдено: ${visibleHolidaysCount} свят`;
                if (isSearch && firstFoundElement) {
                    firstFoundElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            function showTooltip(event, element) {
                const content = element.dataset.tooltipContent;
                if (content) {
                    tooltip.innerHTML = content;
                    tooltip.style.display = 'block';
                    moveTooltip(event);
                }
            }

            function hideTooltip() {
                if (!isTouchDevice) {
                    tooltip.style.display = 'none';
                }
            }
            
            function toggleTooltip(event, element) {
                hideTooltip(); // Hide any existing tooltips
                event.preventDefault(); // Prevent navigation on tap
                showTooltip(event, element);
                setTimeout(hideTooltip, 2000); // Hide after 2 seconds
            }

            function moveTooltip(event) {
                const e = event.touches ? event.touches[0] : event;
                let x = e.clientX + 15;
                let y = e.clientY + 15;

                if (x + tooltip.offsetWidth > window.innerWidth) x = e.clientX - tooltip.offsetWidth - 15;
                if (y + tooltip.offsetHeight > window.innerHeight) y = e.clientY - tooltip.offsetHeight - 15;

                tooltip.style.left = `${x}px`;
                tooltip.style.top = `${y}px`;
            }
            
            function resetFilters() {
                selectCountry('all', 'Всі країни');
                searchFilter.value = '';
                typeFilters.forEach(cb => cb.checked = true);
                updateFilteredHolidays();
            }

            function init() {
                populateCountryFilter();
                switchView('year');

                typeFilters.forEach(cb => cb.addEventListener('change', () => updateFilteredHolidays()));
                searchFilter.addEventListener('input', () => updateFilteredHolidays(true));
                clearFiltersBtn.addEventListener('click', resetFilters);
                
                countryFilterButton.addEventListener('click', () => countryFilterDropdown.classList.toggle('hidden'));
                countrySearchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    countryList.querySelectorAll('li').forEach(li => {
                        const countryName = li.textContent.toLowerCase();
                        li.style.display = countryName.includes(searchTerm) ? 'flex' : 'none';
                    });
                });

                document.addEventListener('click', (e) => {
                    if (!countryFilterButton.contains(e.target) && !countryFilterDropdown.contains(e.target)) {
                        countryFilterDropdown.classList.add('hidden');
                    }
                });
            }

            init();
        });
    </script>
</body>
</html>
